legend(-1.2,7, expression(~ R^2 ~ "= 0.44, p-value < 0.001"), text.col="#E69F00", box.lty=0, bg="transparent", cex=0.9)
with(div, plot(SAND~elev, pch=19, xlab="Elevation (m.s.l.)", ylab= "Percent of soil component", cex=1.2, axes=FALSE, col="goldenrod3", xlim=c(1700,2100), ylim=c(0,80)))
abline(sand.e, lwd=3, col="goldenrod3")
with(div, points(CLAY~elev, pch=19, cex=1.2, col="sienna"))
abline(clay.e, lwd=3, col="sienna")
axis(1)
axis(2)
legend(2010,80, legend=c("Sand", "Clay"), pch=16, pt.cex=1.2, cex=0.6, col = c("goldenrod3", "sienna"))
legend(1670,65, expression(~ R^2 ~ "= 0.21, p-value = 0.024"), text.col="goldenrod3", box.lty=0, bg="transparent", cex=0.9)
legend(1810,30, expression(~ R^2 ~ "= 0.23, p-value = 0.016"), text.col="sienna", box.lty=0, bg="transparent", cex=0.9)
mtext("(c)",side=3,line=-1, adj=0.05,)
TT.plot(class.sys = "USDA.TT", tri.data = div, pch=19, cex.axis=0.8, cex.lab=0.8, lwd=0.8, lwd.axis=0.8, lwd.lab=0.8, main="", cex=0.95, new.mar=c(3.7,3.7,0,0))
mtext("(d)",side=3,line=-1.8, adj=0.05)
dev.off()
jpeg("./analysis/figures/env.jpeg", width=7, height=7, unit="in",res=300)
par(mfrow=c(2,2))
par(mar=c(5,5,0.5,0.5))
par(oma=c(1,1,1,1))
with(div, plot(mean~aspect, pch=19, xlab="Aspect (S = -1, N = 1)", ylab=expression(paste('Temperature (',degree~'C)')), cex=1.2, axes=FALSE, ylim=c(-10,70), col="#E69F00"))
abline(mn.a, lwd=3, col="#E69F00")
with(div, points(max~aspect, pch=19, cex=1.2, col="#D55E00"))
abline(mx.a, lwd=3, col="#D55E00")
with(div, points(min~aspect, pch=19, cex=1.2, col="#56B4E9"))
abline(min, lwd=3, col="#56B4E9")
axis(1)
axis(2, at=c(-10,10,30,50,70))
mtext("(a)",side=3,line=-0.8, adj=0.05)
legend(-0.5,62, expression(~ R^2 ~ "= 0.35, p-value = 0.002"), text.col="#D55E00", box.lty=0, bg="transparent", cex=0.9)
legend(-1.2,25, expression(~ R^2 ~ "= 0.68, p-value < 0.001"), text.col= "#E69F00", box.lty=0, bg="transparent", cex=0.9)
with(div, plot(sd~aspect, pch=19, xlab="Aspect (S = -1, N = 1)", ylab=expression(paste('SD - Temperature (',degree~'C)')), cex=1.2, axes=FALSE, col="#E69F00", ylim=c(5,15)))
abline(sd.a, lwd=3, col="#E69F00")
axis(1)
axis(2, at=c(5,10,15))
mtext("(b)",side=3,line=-0.8, adj=0.05)
legend(0.5,14.5, legend=c('Min', 'Mean', 'Max'), pch=16, pt.cex=1.2, cex=0.6, col = c('#56B4E9', '#E69F00', '#D55E00'))
legend(-1.2,7, expression(~ R^2 ~ "= 0.44, p-value < 0.001"), text.col="#E69F00", box.lty=0, bg="transparent", cex=0.9)
with(div, plot(SAND~elev, pch=19, xlab="Elevation (m.s.l.)", ylab= "Percent of soil component", cex=1.2, axes=FALSE, col="goldenrod3", xlim=c(1700,2100), ylim=c(0,80)))
abline(sand.e, lwd=3, col="goldenrod3")
with(div, points(CLAY~elev, pch=19, cex=1.2, col="sienna"))
abline(clay.e, lwd=3, col="sienna")
axis(1)
axis(2)
legend(2010,80, legend=c("Sand", "Clay"), pch=16, pt.cex=1.2, cex=0.6, col = c("goldenrod3", "sienna"))
legend(1670,65, expression(~ R^2 ~ "= 0.21, p-value = 0.024"), text.col="goldenrod3", box.lty=0, bg="transparent", cex=0.9)
legend(1810,30, expression(~ R^2 ~ "= 0.23, p-value = 0.016"), text.col="sienna", box.lty=0, bg="transparent", cex=0.9)
mtext("(c)",side=3,line=-0.8, adj=0.05,)
TT.plot(class.sys = "USDA.TT", tri.data = div, pch=19, cex.axis=0.8, cex.lab=0.8, lwd=0.8, lwd.axis=0.8, lwd.lab=0.8, main="", cex=0.95, new.mar=c(3.7,3.7,0,0))
mtext("(d)",side=3,line=-1.6, adj=0.05)
dev.off()
jpeg("./analysis/figures/env.jpeg", width=7, height=7, unit="in",res=300)
par(mfrow=c(2,2))
par(mar=c(5,5,0.5,0.5))
par(oma=c(1,1,1,1))
with(div, plot(mean~aspect, pch=19, xlab="Aspect (S = -1, N = 1)", ylab=expression(paste('Temperature (',degree~'C)')), cex=1.2, axes=FALSE, ylim=c(-10,70), col="#E69F00"))
abline(mn.a, lwd=3, col="#E69F00")
with(div, points(max~aspect, pch=19, cex=1.2, col="#D55E00"))
abline(mx.a, lwd=3, col="#D55E00")
with(div, points(min~aspect, pch=19, cex=1.2, col="#56B4E9"))
abline(min, lwd=3, col="#56B4E9")
axis(1)
axis(2, at=c(-10,10,30,50,70))
mtext("(a)",side=3,line=-0.8, adj=0.05)
legend(-0.5,62, expression(~ R^2 ~ "= 0.35, p-value = 0.002"), text.col="#D55E00", box.lty=0, bg="transparent", cex=0.9)
legend(-1.2,25, expression(~ R^2 ~ "= 0.68, p-value < 0.001"), text.col= "#E69F00", box.lty=0, bg="transparent", cex=0.9)
with(div, plot(sd~aspect, pch=19, xlab="Aspect (S = -1, N = 1)", ylab=expression(paste('SD - Temperature (',degree~'C)')), cex=1.2, axes=FALSE, col="#E69F00", ylim=c(5,15)))
abline(sd.a, lwd=3, col="#E69F00")
axis(1)
axis(2, at=c(5,10,15))
mtext("(b)",side=3,line=-0.8, adj=0.05)
legend(0.5,14.5, legend=c('Min', 'Mean', 'Max'), pch=16, pt.cex=1.2, cex=0.6, col = c('#56B4E9', '#E69F00', '#D55E00'))
legend(-1.2,6.5, expression(~ R^2 ~ "= 0.44, p-value < 0.001"), text.col="#E69F00", box.lty=0, bg="transparent", cex=0.9)
with(div, plot(SAND~elev, pch=19, xlab="Elevation (m.s.l.)", ylab= "Percent of soil component", cex=1.2, axes=FALSE, col="goldenrod3", xlim=c(1700,2100), ylim=c(0,80)))
abline(sand.e, lwd=3, col="goldenrod3")
with(div, points(CLAY~elev, pch=19, cex=1.2, col="sienna"))
abline(clay.e, lwd=3, col="sienna")
axis(1)
axis(2)
legend(2010,80, legend=c("Sand", "Clay"), pch=16, pt.cex=1.2, cex=0.6, col = c("goldenrod3", "sienna"))
legend(1670,65, expression(~ R^2 ~ "= 0.21, p-value = 0.024"), text.col="goldenrod3", box.lty=0, bg="transparent", cex=0.9)
legend(1810,30, expression(~ R^2 ~ "= 0.23, p-value = 0.016"), text.col="sienna", box.lty=0, bg="transparent", cex=0.9)
mtext("(c)",side=3,line=-0.8, adj=0.05,)
TT.plot(class.sys = "USDA.TT", tri.data = div, pch=19, cex.axis=0.8, cex.lab=0.8, lwd=0.8, lwd.axis=0.8, lwd.lab=0.8, main="", cex=0.95, new.mar=c(3.7,3.7,0,0))
mtext("(d)",side=3,line=-1.6, adj=0.05)
dev.off()
summary(mn.a)
mean.corr
xtable(mean.corr)
install.packages("xtable")
mean.corr
xtable(mean.corr)
library(xtable)
xtable(mean.corr)
cor.test.env <- function(div,RV){
output <- c(with(div, cor.test(RV,aspect))$estimate, with(div, cor.test(RV, elev))$estimate, with(div, cor.test(RV, slope))$estimate,
with(div, cor.test(RV, SAND))$estimate, with(div, cor.test(RV, SILT))$estimate, with(div, cor.test(RV, CLAY))$estimate)
output <- as.data.frame(rbind(output, c(with(div, cor.test(RV, aspect))$p.value, with(div, cor.test(RV, elev))$p.value, with(div, cor.test(RV, slope))$p.value,
with(div, cor.test(RV, SAND))$p.value, with(div, cor.test(RV, SILT))$p.value, with(div, cor.test(RV, CLAY))$p.value)))
colnames(output) <- c("aspect","elev","slope","sand","silt","clay")
rownames(output) <- c("pearsons.r", "p.value")
return(output)
}
cor.test.soil <<- function(div,RV){
output <- c(with(div, cor.test(RV,aspect))$estimate, with(div, cor.test(RV, elev))$estimate, with(div, cor.test(RV, slope))$estimate)
output <- as.data.frame(rbind(output, c(with(div, cor.test(RV, aspect))$p.value, with(div, cor.test(RV, elev))$p.value, with(div, cor.test(RV, slope))$p.value)))
colnames(output) <- c("aspect","elev","slope")
rownames(output) <- c("pearsons.r", "p.value")
return(output)
}
mean.corr <- cor.test.env(div, div$mean)
sd.corr <- cor.test.env(div, div$sd)
min.corr <- cor.test.env(div, div$min)
max.corr <- cor.test.env(div, div$max)
sand.corr <- cor.test.soil(div, div$SAND)
silt.corr <- cor.test.soil(div, div$SILT)
clay.corr <- cor.test.soil(div, div$CLAY)
mean.corr
temp.cors <- rbind(mean.corr, sd.corr, max.corr, min.corr)
xtable(temp.cors)
?xtable
xtable(temp.cors, digits=3)
soil.cors <- rbind(sand.corr, silt.corr, clay.corr)
xtable(soil.cors, digits=3)
summary(mn.a)
summary(mx.a)
summary(sand.e)
summary(clay.e)
summary(sla.mn)
summary(la.mn)
summary(fdis.mn)
summary(mxH.mn)
xtable(summary(sla))
xtable(summary(la))
xtable(summary(mxH))
xtable(summary(mnH))
xtable(summary(fdis))
xtable(fdis.two)
fdis.mntd <- with(div, lm(fdis~sesmntd+sesmpd+pd+nsp+simpsdiv))
summary(fdis.mntd)
fdis <- with(div, lm(fdis~sesmntd+sesmpd+pd+nsp+simpsdiv))
vif(fdis)
#########################################################################
# How does functional diversity (dispersion and CWM) correlate with phylodiversity? (25 plots)
cor.test.phy <<- function(div,RV){
output <- c(with(div, cor.test(RV,sesmntd))$estimate, with(div, cor.test(RV, sesmpd))$estimate, with(div, cor.test(RV, pd))$estimate,
with(div, cor.test(RV, nsp))$estimate, with(div, cor.test(RV, simpsdiv))$estimate)
output <- as.data.frame(rbind(output, c(with(div, cor.test(RV, sesmntd))$p.value, with(div, cor.test(RV, sesmpd))$p.value, with(div, cor.test(RV, pd))$p.value,
with(div, cor.test(RV, nsp))$p.value, with(div, cor.test(RV, simpsdiv))$p.value)))
colnames(output) <- c("sesmntd","sesmpd","pd","nsp","simpsdiv")
rownames(output) <- c("pearsons.r", "p.value")
return(output)
}
fdis.phycor <- cor.test.phy(div, div$fdis)
fdis.phycor
fdis.mntd <- with(div, lm(fdis~sesmntd+sesmpd))
vif(fdis.mntd)
summary(fdis.mntd)
vif(fdis)
fdis.mntd <- with(div, lm(fdis~sesmntd+sesmpd+simpsdiv))
fdis.mntd
summary(fdis.mntd)
fdis.phy <- with(div, lm(fdis~sesmntd+sesmpd+simpsdiv))
fdis.phyall <- with(div, lm(fdis~sesmntd+sesmpd+pd+nsp+simpsdiv)) # VIF high for pd, sesmntd, and nsp
fdis.phycor <- cor.test.phy(div, div$fdis) # mntd most correlated of those three
fdis.phy <- with(div, lm(fdis~sesmntd+sesmpd+simpsdiv)) # mntd* + mpd
la.phyall <- with(div, lm(log(CWM.LA)~sesmntd+sesmpd+pd+nsp+simpsdiv))
summary(la.phyall)
vif(la.phyall)
la.phycor <- cor.test.phy(div, log(div$CWM.SLA))
la.phycor
la.phy <- with(div, lm(log(CWM.LA)~pd+sesmpd+simpsdiv))
summary(la.phy)
la.phycor <- cor.test.phy(div, log(div$CWM.LA)) # pd most correlated of those three
la.phycor
sla.phyall <- with(div, lm(log(CWM.SLA)~sesmntd+sesmpd+pd+nsp+simpsdiv)) # VIF high for pd, sesmntd, and nsp
sla.phycor <- cor.test.phy(div, log(div$CWM.SLA)) # pd most correlated of those three
sla.phycor
sla.phy <- with(div, lm(log(CWM.SLA)~pd+sesmpd+simpsdiv))
summary(sla.phy)
vif(la.phy)
vif(sla.phy)
mxH.phyall <- with(div, lm(CWM.maxht~sesmntd+sesmpd+pd+nsp+simpsdiv)) # VIF high for pd, sesmntd, and nsp
vif(mxHT.phyall)
vif(mxH.phyall)
mxH.phycor <- cor.test.phy(div, CWM.maxht) # pd most correlated of those three
mxH.phycor <- cor.test.phy(div, div$CWM.maxht) # pd most correlated of those three
summary(mxH.phycor)
sla.phycor
mxH.phycor <- cor.test.phy(div, div$CWM.maxht) # pd most correlated of those three
mxH.phycor
mxH.phy <- with(div, lm(CWM.maxht~mntd+sesmpd+simpsdiv)) #
mxH.phy <- with(div, lm(CWM.maxht~sesmntd+sesmpd+simpsdiv)) #
summary(mxH.phy)
summary(fdis.phy)
mxH.phyall <- with(div, lm(CWM.maxht~sesmntd+sesmpd+pd+nsp+simpsdiv)) # VIF high for pd, sesmntd, and nsp
mnH.phyall <- with(div, lm(CWM.mn.ht~sesmntd+sesmpd+pd+nsp+simpsdiv)) # VIF high for pd, sesmntd, and nsp
vif(mnH.phyall)
mnH.phycor <- cor.test.phy(div, div$CWM.mn.ht) # mntd most correlated of those three
mnH.phycor
mnH.phy <- with(div, lm(CWM.mn.ht~sesmntd+sesmpd+simpsdiv))
summary(mnH.phy)
#for plotting
fdis.mntd <- with(div, lm(fdis~sesmntd))
summary(fdis.mntd)
# for plotting
la.mntd <- with(div, lm(log(CWM.LA)~pd))
summary(la.mntd)
head(div)
# for plotting
mnH.mntd <- with(div, lm(CWM.mn.ht~sesmtnd))
# for plotting
mnH.mntd <- with(div, lm(CWM.mn.ht~sesmntd))
summary(mnH.mntd)
mxH.phycor
mnH.phycor
summary(la.pd)
# for plotting
la.pd <- with(div, lm(log(CWM.LA)~pd))
# for plotting
fdis.mntd <- with(div, lm(fdis~sesmntd))
# for plotting
mxH.mntd <- with(div, lm(CWM.maxht~sesmntd))
# for plotting
mnH.mntd <- with(div, lm(CWM.mn.ht~sesmntd))
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, col="#009E73"))
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, col="#009E73"))
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, col="#009E73"))
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, col="#009E73"))
summary(la.pd)
# Functional dispersion acro SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, col="#0072B2"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
summary(fdis.mntd)
summary(mxH.mntd)
jpeg("./functional_traits_rhf/analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=3, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=3, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=3, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(a)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(CWM.maxht~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(b)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=2.5, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, ylim=c(0,5), col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(a)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(CWM.maxht~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, ylim=c(0,1400), col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(b)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, ylim=c(-2,4),col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=2.5, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, ylim=c(0,5), col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(a)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(CWM.maxht~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, ylim=c(0,1400), col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(b)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, ylim=c(-2,4),col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=2.5, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, ylim=c(0,5), col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(a)",side=3,line=-0.9, adj=0.025, cex=0.8)
legend(-1,5.2, expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(CWM.maxht~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, ylim=c(0,1400), col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(b)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, ylim=c(-3,4),col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=2.5, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, ylim=c(0,5), col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(a)",side=3,line=-0.5, adj=0.01, cex=0.8)
legend(-0.5,5.5, expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(CWM.maxht~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, ylim=c(0,1400), col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(b)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, ylim=c(-3,4),col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=2.5, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, ylim=c(0,5), col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(a)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend(-1.5,4, expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(CWM.maxht~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, ylim=c(0,1400), col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(b)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, ylim=c(-3,4),col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
# FIG 4 - Functional diversity across phy-div metrics at 25 plots
# Plot significant relationships with SESmntd here, do the rest in the supplement
jpeg("./analysis/figures/fdiv-phydiv-25plots.jpeg", width=7, height=2.5, unit="in",res=300)
par(mfrow=c(1,3))
par(mar=c(4,5,0.1,0.5))
par(oma=c(1,1,1,1))
# Functional dispersion across SESmntd
with(div, plot(fdis~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Functional dispersion", cex=1.2, axes=FALSE, ylim=c(0,5), col="#0072B2"))
abline(fdis.mntd, lwd=3)
axis(1)
axis(2)
mtext("(a)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend(-1.5,4.5, expression(R^2 ~ "= 0.69, p-value < 0.001"),cex=0.9, bty="n")
# CWM of maximum height across SESmntd
with(div, plot(CWM.maxht~sesmntd, pch=19, xlab=expression(SES[MNTD]), ylab="Maximum height (cm)", cex=1.2, axes=FALSE, ylim=c(0,1400), col="#E69F00"))
abline(mxH.mntd, lwd=3)
axis(1)
axis(2)
mtext("(b)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend(-2,1200, expression(R^2 ~ "= 0.71, p-value < 0.001"),cex=0.9, bty="n")
# CWM of leaf area across PD
with(div, plot(log(CWM.LA)~pd, pch=19, xlab="Faith's PD", ylab=expression(italic("ln")(CWM~-~LA)), cex=1.2, axes=FALSE, ylim=c(-3,4),col="#009E73"))
abline(la.pd, lwd=3)
axis(1)
axis(2)
mtext("(c)",side=3,line=-1.2, adj=0.05, cex=0.8)
legend("topright", expression(R^2 ~ "= 0.34, p-value = 0.002"),cex=0.9, bty="n")
legend("bottomright", legend=c('Overall FD', 'Leaf traits', 'Height traits'), pch=19, pt.cex=1, cex=.8,
col = c('#0072B2', '#009E73', '#E69F00'))
dev.off()
phycor <- rbind(fdis.phycor, la.phycor, sla.phycor, mxH.phycor, mnH.phycor)
phycor
xtable(phycor)
xtable(phycor, digits=3)
xtable(fdis.phy, digits=3)
xtable(la.phy, digits=3)
xtable(sla.phy, digits=3)
xtable(mxH.phy, digits=3)
xtable(mnH.phy, digits=3)
xtable(fdis.phy, digits=3)
xtable(la.phy, digits=3)
xtable(sla.phy, digits=3)
summary(fdis.mntd)
summary(mxH.mntd)
summary(la.pd)
